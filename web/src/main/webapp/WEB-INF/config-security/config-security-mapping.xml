<!--
  ~ Copyright (C) 2001-2017 Food and Agriculture Organization of the
  ~ United Nations (FAO-UN), United Nations World Food Programme (WFP)
  ~ and United Nations Environment Programme (UNEP)
  ~
  ~ This program is free software; you can redistribute it and/or modify
  ~ it under the terms of the GNU General Public License as published by
  ~ the Free Software Foundation; either version 2 of the License, or (at
  ~ your option) any later version.
  ~
  ~ This program is distributed in the hope that it will be useful, but
  ~ WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
  ~ General Public License for more details.
  ~
  ~ You should have received a copy of the GNU General Public License
  ~ along with this program; if not, write to the Free Software
  ~ Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301, USA
  ~
  ~ Contact: Jeroen Ticheler - FAO - Viale delle Terme di Caracalla 2,
  ~ Rome - Italy. email: geonetwork@osgeo.org
  -->

<beans
  xsi:schemaLocation="http://www.springframework.org/schema/beans
          http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
          http://www.springframework.org/schema/security
          http://www.springframework.org/schema/security/spring-security-3.2.xsd"
  xmlns:sec="http://www.springframework.org/schema/security"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns="http://www.springframework.org/schema/beans">
  <bean class="org.springframework.security.web.access.intercept.FilterSecurityInterceptor"
        id="filterSecurityInterceptor">
    <property name="authenticationManager" ref="authenticationManager"></property>
    <property name="accessDecisionManager" ref="accessDecisionManager"></property>
    <property name="securityMetadataSource">
      <sec:filter-security-metadata-source use-expressions="true" request-matcher="regex">
        <sec:intercept-url pattern="/metadata/.*" access="permitAll"/>

        <!-- Secure proxy URL if needed eg. restrict to some host only. -->
        <sec:intercept-url pattern="/proxy\?url=.*" access="permitAll"/>
        <!--<sec:intercept-url pattern="/proxy\?url=.*(www.brgm.fr|www.ifremer.fr).*" access="permitAll"/>-->

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+" access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/metadata/.*" access="permitAll"/>
        <sec:intercept-url pattern="/static/wroAPI/.*" access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/static/.*" access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.thesaurus.getList!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/monitor/.*" access="hasRole('Monitor')"/>
        <sec:intercept-url pattern="/monitor" access="hasRole('Monitor')"/>
        <sec:intercept-url pattern="/\w*healthcheck"
                           access="hasRole('Monitor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/service-not-allowed!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/.+\?casLogin.*"
                           access="hasRole('RegisteredUser')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/util.import!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/util.ping!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/util.empty!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/util.select!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/help.edit.form!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/help.update!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/thesaurus.add.register!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.config.info!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/config.info!?.*"
                           access="hasRole('Administrator')"/>


        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/debug.openconnection.accessors!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/debug.filehandles!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.batch.newowner!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.batch.newowner.form!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.usergroups.list!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/group.get!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.category!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.category.form!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.batch.category.form!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url
          pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.batch.update.categories!?.*"
          access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.status!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.status.form!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.metadata.status.set!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.batch.status.form!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.batch.update.status!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.add!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.add.form!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.metadata.admin.form!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url
          pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.metadata.batch.update.privileges!?.*"
          access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.publish!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.unpublish!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.batch.admin.form!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.version!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.batch.version!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.delete!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.batch.delete!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.create.thesaurus.form!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.create.new!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.create.edit!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.elem.add.new!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.elem.delete.new!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.elem.down!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.elem.up!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.attr.delete!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.update.new!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.update.finish!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.update.forget!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.update.forget.new!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.update.forgetandfinish!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.batch.children.form!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.batch.update.children!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.suggestion!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.metadata.validate!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.processing.new!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.metadata.processing!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url
          pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.batch.extract.subtemplates.form!?.*"
          access="hasRole('Editor')"/>
        <sec:intercept-url
          pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.batch.extract.subtemplates!?.*"
          access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.user.metadata!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.insert.paste!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.metadata.insert.paste!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/file.upload!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/resources.upload.new!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/resources.del.new!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.thumbnail.set.new!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.thumbnail.unset.new!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.metadata.insert!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.metadata.delete!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/mef.import!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/mef.import.ui!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.mef.import.ui!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/map.import!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/get.conversions.xsl!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.relation.insert!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.relation.delete!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/geoserver.publisher!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/home!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/main.error!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.thumbnail!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.relation!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.relation!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/user.logout!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/user.privileges.error!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/res!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/feedback.send!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/file.download!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/file.disclaimer!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/feedback.download.insert!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/resources.get!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/resources.get.archive!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/prepare.file.download!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/external.getmetadata!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/resources.getgraphover!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/graphover.show!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.select!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/pdf.selection.search!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/pdf.present!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/pdf!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.search!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.search.keywords!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.metadata.get!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/rdf.metadata.get!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/rdf.search!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.metadocument.snippet!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.metadocument.get!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.info!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.keyword.get!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.file.disclaimer!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.file.download!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.metadata.status.get!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/view!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/edit!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/portal.search!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/portal.opensearch!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/portal.search.keywords!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/portal.search.credits!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/portal.search.present!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/portal.present!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/portal.full!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/portal.get!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/portal.latest.updated!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/portal.featured!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/portal.categories!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/portal.sources!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/portal.sitemap!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/pdf.search!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml_dublin-core!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml_dublin-coreTooai_dc!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml_fgdc-std!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml_fgdc-stdTooai_dc!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml_iso19115to19139!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml_iso19115toarccatalog8!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml_iso19115Tooai_dc!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml_iso19139!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml_iso19139Tooai_dc!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml_iso19110!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml_iso19110Tooai_dc!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml_csw-record!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml_csw-recordTooai_dc!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/rss.latest!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/rss.search!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/rss.present!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/csv.search!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/csv.present!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/google.kml!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.group.list!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/mef.export!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.relation.get!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.schema.info!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.metadata.rate!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/keywords.editsearch!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/thesaurus.list!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/thesaurus.view!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/crs.types!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/crs.get!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/contacts.search!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/contacts.sort!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/contacts.select!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/contacts.editsearch!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/contacts.getselected!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/contacts.getRole!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/isolanguages!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/search/facet/config"
                           access="permitAll"/>

        <sec:intercept-url pattern="/wmc/load.wmc" access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/selection.layers!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/robots.txt"
                           access="permitAll"/>
        <sec:intercept-url pattern="/robots.txt" access="permitAll"/>

        <!-- Region services -->
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.region.get!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.regions.list!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.regions.category.list!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/region.getmap.\w\w\w\?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/region\.geom\.\w\w\w!?.*"
                           access="permitAll"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadata.batch.replace.form!?.*"
                           access="hasRole('Editor')"/>


        <!-- New section of services based on refactoring
        guideline https://github.com/geonetwork/core-geonetwork/wiki/RefactoringXSLTAndUserInterface -->
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/q!?.*" access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/qi!?.*" access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/suggest!?.*" access="permitAll"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/info!?.*" access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/translation/db!?.*"
                           access="permitAll"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/oaipmh!?.*" access="permitAll"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.group.list!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.group.get!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.group.update!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.group.update.labels!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.group.remove!?.*"
                           access="hasRole('Administrator')"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.user!?\?.*"
                           access="hasRole('RegisteredUser')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.user.list!?.*"
                           access="hasRole('RegisteredUser')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.user.update!?.*"
                           access="hasRole('RegisteredUser')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.user.resetpassword"
                           access="hasRole('RegisteredUser')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.user.remove!?.*"
                           access="hasRole('UserAdmin')"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.usergroups.list!?.*"
                           access="hasRole('RegisteredUser')"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.category.update!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.category.remove!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.category.update.labels!?.*"
                           access="hasRole('UserAdmin')"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.logo.list!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.logo.update!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.logo.remove!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.logo.upload!?.*"
                           access="hasRole('UserAdmin')"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.config.list!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.config.save!?.*"
                           access="hasRole('Administrator')"/>


        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.notifications.list!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.notifications.save!?.*"
                           access="hasRole('Administrator')"/>


        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.config.csw!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.config.csw.save!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url
          pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.config.csw.customelementset!?.*"
          access="hasRole('Administrator')"/>
        <sec:intercept-url
          pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.config.csw.customelementset.save!?.*"
          access="hasRole('Administrator')"/>


        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.config.virtualcsw.list!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.config.virtualcsw.get!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.config.virtualcsw.update!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.config.virtualcsw.remove!?.*"
                           access="hasRole('Administrator')"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.index.rebuild!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.index.optimize!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.index.rebuildxlinks!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.index.config.reload!?.*"
                           access="hasRole('Administrator')"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.schema.list!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.schema.update!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.schema.add!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.schema.remove!?.*"
                           access="hasRole('Administrator')"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.load.samples!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.load.templates!?.*"
                           access="hasRole('Administrator')"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.templates.list!?.*"
                           access="hasRole('Reviewer')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.templates.save.order!?.*"
                           access="hasRole('Reviewer')"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.harvester.list!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.harvester.add!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.harvester.update!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.harvester.clone!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.harvester.remove!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.harvester.clear!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.harvester.stop!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.harvester.start!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.harvester.run!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.harvester.info!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.harvester.history!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.harvester.history.full!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.harvester.history.delete!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.harvester.log!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.harvester.notifier.save!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.harvester.notifier.get!?.*"
                           access="hasRole('UserAdmin')"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/statistics-search-ip?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url
          pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/statistics-search-by-service-type?.*"
          access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/statistics-search-by-date?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/statistics-search-fields?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/statistics-search-terms?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/statistics-search?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/statistics-search-export?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/statistics-content?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/statistics-content-metadata?.*"
                           access="hasRole('Editor')"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/keywords!?.*" access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/thesaurus.upload!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/thesaurus.add.from.register!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/thesaurus.clear!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/thesaurus.update!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/thesaurus.remove!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/thesaurus.enable!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/thesaurus.keyword.add!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/thesaurus.keyword.update!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/thesaurus.keyword.remove!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/thesaurus.download!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/thesaurus.topconcept!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/thesaurus.concept!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/thesaurus.keyword!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/thesaurus.keyword.links!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/thesaurus!?.*" access="permitAll"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/subtemplate!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.select!?.*" access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.selected!?.*"
                           access="permitAll"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.create!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.delete!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.delete.batch!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.insert!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.import!?.*"
                           access="hasRole('Editor')"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/api/.*" access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/search.*" access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/resources!?.*" access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.rate!?.*" access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.view!?(\?.*)?"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.edit.batch.config!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.edit.batch!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.edit!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.edit.save!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.edit.saveonly!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.edit.save.and.close!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.edit.cancel!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.edit.commit!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.element.add!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.element.remove!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.element.up!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.element.down!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.element.info!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.attribute.remove!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.thumbnail.generate!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.thumbnail.upload!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.thumbnail.remove!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.validate!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.validation!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.status.list!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.status.update!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.group.update!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.category.update!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.category.batch.update!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.versioning.start!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.versioning.batch.start!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.privileges!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.privileges.update!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.privileges.batch!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.privileges.batch.update!?.*"
                           access="hasRole('Editor')"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.processing.batch!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.processing!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.processing.batch.report!?.*"
                           access="hasRole('Editor')"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.relations!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.suggestion!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/resource.upload.and.link!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/resource-onlinesrc-upload!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/resource.del.and.detach!?.*"
                           access="hasRole('Editor')"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/versioning.logdata!?.*"
                           access="hasRole('Editor')"/>

        <sec:intercept-url
          pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/config-service-admin-batchprocess.xml!?.*"
          access="hasRole('Editor')"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/csw-publication!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/csw-.*" access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/csw!?.*" access="permitAll"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/region.get!?.*" access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/regions.list!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/regions.category.list!?.*"
                           access="permitAll"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/lang!?.*" access="permitAll"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/portal.sru!?.*" access="permitAll"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/catalog.search!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/catalog.signin!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/contact.us!?.*" access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/contact.send!?.*"
                           access="permitAll"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.ownership.editors!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.ownership.groups!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.ownership.transfer!?.*"
                           access="hasRole('Administrator')"/>


        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.languages.get!?.*"
                           access="permitAll"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.console!?.*"
                           access="hasRole('RegisteredUser')"/>

        <!-- Formatter services -->
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.format.public..[^?]+(\?.*)?"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.formatter.resource!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.formatter.list!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.formatter.register!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.formatter.remove!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.formatter.download!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.formatter.update!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.formatter.files!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.formatter.edit!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/xml.format.[^?]+(\?.*)?"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/md.format.[^?]+(\?.*)?"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.format.clear"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/display(\?debug)?"
                           access="permitAll"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/crs.search!?.*" access="permitAll"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/new.account!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/create.account!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/new.password!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/password.reminder!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/password.change!?.*"
                           access="permitAll"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/catalog.edit!?.*"
                           access="hasRole('Editor')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/catalog.viewer!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/node-change-warning!?.*"
                           access="permitAll"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/system.properties.set!?.*"
                           access="hasRole('Administrator')"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.schematrontype!?.*"
                           access="hasRole('Administrator')"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.schematron.list!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.schematron.exists!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.schematron.update!?.*"
                           access="hasRole('Administrator')"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.schematroncriteria.list!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.schematroncriteria.exists!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.schematroncriteria.add!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.schematroncriteria.update!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.schematroncriteria.delete!?.*"
                           access="hasRole('Administrator')"/>

        <sec:intercept-url
          pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.schematroncriteriagroup.list!?.*"
          access="hasRole('Administrator')"/>
        <sec:intercept-url
          pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.schematroncriteriagroup.exists!?.*"
          access="hasRole('Administrator')"/>
        <sec:intercept-url
          pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.schematroncriteriagroup.add!?.*"
          access="hasRole('Administrator')"/>
        <sec:intercept-url
          pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.schematroncriteriagroup.update!?.*"
          access="hasRole('Administrator')"/>
        <sec:intercept-url
          pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.schematroncriteriagroup.delete!?.*"
          access="hasRole('Administrator')"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/admin.logfile.list!?.*"
                           access="hasRole('Administrator')"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/systeminfo/.+"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/source/.+"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/thread/status"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/thread/trace/.+"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/thread/debugging/.+"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/log/.+"
                           access="hasRole('Administrator')"/>

        <!-- Direct links -->
        <sec:intercept-url pattern="/resource/.*" access="permitAll"/>
        <sec:intercept-url pattern="/organization/.*" access="permitAll"/>
        <sec:intercept-url pattern="/thesaurus/.*" access="permitAll"/>

        <sec:intercept-url pattern="/sitemap/.*" access="permitAll"/>


        <!-- Reports -->
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/recordsupdated.csv!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/recordsinternal.csv!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/users.csv!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/datauploads.csv!?.*"
                           access="hasRole('UserAdmin')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/datadownloads.csv!?.*"
                           access="hasRole('UserAdmin')"/>

        <!-- INSPIRE Atom -->
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/atomharvester!?.*"
                           access="hasRole('Administrator')"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/atom.get!?.*" access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/atom.description!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/opensearch/[a-z]{2,3}/!?.*" access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/atom.describe!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/atom.download!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/atom.search!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/atom.search.html!?.*"
                           access="permitAll"/>

        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/atom.predefined.service!?.*" access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/atom.predefined.dataset!?.*" access="permitAll"/>

        <!-- Metadata identifier templates -->
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/metadataIdentifierTemplates!?.*"
                           access="hasRole('Editor')"/>

        <!-- Retrieve public metadata as RDF  -->
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/rdf.metadata.public.get!?.*"
                           access="permitAll"/>

        <sec:intercept-url pattern="/error" access="permitAll"/>
        <sec:intercept-url pattern="/home\?.*" access="permitAll"/>
        <sec:intercept-url pattern="/home" access="permitAll"/>
        <sec:intercept-url pattern="/rewritestatus" access="permitAll"/>

        <!-- SLD helpers -->
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/generateSLD!?.*"
                           access="permitAll"/>
        <sec:intercept-url pattern="/[a-zA-Z0-9_\-]+/[a-z]{2,3}/getSLD/.*" access="permitAll"/>

        <sec:intercept-url pattern="/.*" access="denyAll"/>
      </sec:filter-security-metadata-source>
    </property>
  </bean>
</beans>
