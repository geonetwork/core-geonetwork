<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>GeoNetwork JS API testing page</title>
    <!--<link href="/geonetwork/static/gn_search_default.css" rel="stylesheet" media="screen">-->
    <link
      href="http://localhost:8080/geonetwork/static/gn_search_sextant.css"
      rel="stylesheet"
      media="screen"
    />
    <link
      href="http://localhost:8080/geonetwork/static/api.css"
      rel="stylesheet"
      media="screen"
    />
  </head>
  <body>
    <div
      ng-app="gn_search_sextant"
      ng-controller="GnCatController"
      class="gn sxt-max-md"
      sxt-size="auto"
      ng-include="'../../sextant/views/sextant/templates/index.html'"
    ></div>

    <script type="text/javascript">
      var sxtGnUrl = "http://gnapi/geonetwork/srv/";
      var sxtSettings = {
        langDetector: {
          //fromHtmlTag: true,
          //regexp: '^\/([a-z]+)\/',
          lang: "fr"
        },
        //configWhat: 'AMBIO',
        tabOverflow: {
          search: true,
          panier: true,
          map: false
        },
        //defaultContext: 'https://www.ifremer.fr/sextant_doc/atlas_benthal/contexte/atl_benthal_atlantique_test.xml',
        //defaultContext: '../../sextant/views/sextant/data/benthos_atl_context.xml',
        //viewerUrl: 'http://oceanbrowser.net/emodnet/',
        //layerFilter: true,
        olView: {
          extent: [-9.62, 41.18, 10.3, 51.54],
          maxResolution: 2445.98490512564
        },
        servicesUrl: {
          wms: [
            {
              name: "Ifremer - Biologie",
              url: "ttp://www.ifremer.fr/services/wms/biologie?"
            }
          ],
          wmts: [
            {
              name: "Ifremer - maps.ngdc.noaa.gov",
              url: "http://maps.ngdc.noaa.gov/arcgis/rest/services/web_mercator/etopo1_hillshade/MapServer/WMTS/1.0.0/WMTSCapabilities.xml"
            }
          ]
        },
        localisations: [],
        panier: {
          projs: [
            {
              value: "4326",
              label: "Geographique - Datum WGS84"
            }
          ],
          formats: {
            vector: [
              {
                value: "ESRI Shapefile",
                label: "ESRI Shapefile"
              },
              {
                value: "GeoJSON",
                label: "GeoJSON"
              }
            ],
            raster: [
              {
                value: "GeoTiff",
                label: "GeoTiff"
              }
            ]
          }
        },
        facetConfig: [
          {
            key: "publishedForGroup",
            index: "_groupPublished"
          },
          {
            key: "category"
          },
          {
            langs: {
              eng: "inspireTheme_en",
              fre: "inspireTheme_fr"
            }
          }
        ]
      };
    </script>

    <script src="/geonetwork/catalog/lib/modernizr.js"></script>
    <script src="/geonetwork/catalog/lib/closure/base.js"></script>
    <script src="/geonetwork/catalog/lib/base64.js"></script>
    <script src="/geonetwork/catalog/lib/jquery-2.2.24.js"></script>
    <script src="/geonetwork/catalog/lib/moment+langs.min.js"></script>
    <script src="/geonetwork/catalog/lib/angular/angular.js"></script>
    <script src="/geonetwork/catalog/lib/angular/angular-resource.js"></script>
    <script src="/geonetwork/catalog/lib/angular/angular-route.js"></script>
    <script src="/geonetwork/catalog/lib/angular/angular-sanitize.js"></script>
    <script src="/geonetwork/catalog/lib/angular/angular-gettext.min.js"></script>
    <script src="/geonetwork/catalog/lib/angular/angular-cookies.js"></script>
    <script src="/geonetwork/catalog/lib/angular-translate.js"></script>
    <script src="/geonetwork/catalog/lib/angular-md5.js"></script>
    <script src="/geonetwork/catalog/lib/angular-filter.min.js"></script>
    <script src="/geonetwork/catalog/lib/angular.ext/hotkeys/hotkeys.js"></script>
    <script src="/geonetwork/catalog/lib/angular.ext/datetimepicker.js"></script>
    <script src="/geonetwork/catalog/lib/angular.ext/buttons.js"></script>
    <script src="/geonetwork/catalog/lib/angular.ext/rating.js"></script>
    <script src="/geonetwork/catalog/lib/angular.ext/typeahead.js"></script>
    <script src="/geonetwork/catalog/lib/angular.ext/position.js"></script>
    <script src="/geonetwork/catalog/lib/angular.ext/bindHtml.js"></script>
    <script src="/geonetwork/catalog/lib/angular.ext/tabs.js"></script>
    <script src="/geonetwork/catalog/lib/angular.ext/slider.js"></script>
    <script src="/geonetwork/catalog/lib/angular.ext/colorpicker/angularjs-color-picker.js"></script>
    <script src="/geonetwork/catalog/lib/tinycolor.js"></script>
    <script src="/geonetwork/catalog/lib/style/bootstrap/dist/js/bootstrap.js"></script>
    <script src="/geonetwork/catalog/lib/jquery.ext/jquery-ui-slider.min.js"></script>
    <script src="/geonetwork/catalog/lib/proj4js-compressed.js"></script>

    <!-- No 3D. -->
    <script src="/geonetwork/catalog/lib/ngeo/ngeo-debug.js"></script>

    <!-- For 3D. -->
    <!--
<script src="/geonetwork/catalog/lib/ol3cesium/Cesium/Cesium.js"></script>
<script src="/geonetwork/catalog/lib/ol3cesium/ngeool3cesium-debug.js"></script>
-->

    <script src="/geonetwork/catalog/lib/FileSaver/FileSaver.min.js"></script>
    <script src="/geonetwork/catalog/lib/tableExport/tableExport.min.js"></script>
    <script src="/geonetwork/catalog/lib/zip/zip.js"></script>
    <script src="/geonetwork/catalog/lib/jsonix/jsonix/Jsonix-min.js"></script>
    <script type="text/javascript">
      zip.workerScriptsPath = "/geonetwork/catalog/lib/zip/";
    </script>
    <script src="/geonetwork/catalog/lib/jquery.ext/jquery.ui.widget.js"></script>
    <script src="/geonetwork/catalog/lib/jquery.ext/jquery.iframe-transport.js"></script>
    <script src="/geonetwork/catalog/lib/jquery.ext/jquery.fileupload.js"></script>
    <script src="/geonetwork/catalog/lib/jquery.ext/jquery.fileupload-process.js"></script>
    <script src="/geonetwork/catalog/lib/jquery.ext/jquery.fileupload-angular.js"></script>
    <script src="/geonetwork/catalog/lib/bootstrap.ext/typeahead.js/typeahead.bundle.js"></script>
    <script src="/geonetwork/catalog/lib/bootstrap.ext/typeahead.js/handlebars-v2.0.0.js"></script>
    <script src="/geonetwork/catalog/lib/bootstrap.ext/tagsinput/bootstrap-tagsinput.js"></script>
    <script src="/geonetwork/catalog/lib/bootstrap.ext/datepicker/bootstrap-datepicker.js"></script>
    <script src="/geonetwork/catalog/lib/bootstrap-table/dist/bootstrap-table.js"></script>
    <script src="/geonetwork/catalog/lib/bootstrap-table/src/extensions/export/bootstrap-table-export.js"></script>

    <script src="/geonetwork/static/closure_deps.js"></script>

    <script src="/geonetwork/catalog/lib/zip/zip.js"></script>
    <script src="/geonetwork/catalog/lib/zip/include.js"></script>
    <script src="/geonetwork/catalog/lib/base64.js"></script>
    <!--<script src="/geonetwork/catalog/views/sextant/settings.js"></script>-->
    <script src="/geonetwork/catalog/views/sextant/jquerypluginsnoconflict.js"></script>

    <script>
      goog.require("sx_search_sextant");
    </script>

    <script type="text/javascript">
      // Parse config from config URL parameter
      var tokens = /config=([^&]+)/.exec(window.location.search),
        config = tokens ? tokens[1] : undefined,
        defaultConfig = {
          langDetector: {
            fromHtmlTag: true,
            default: "en"
          },
          nodeDetector: {
            default: "srv"
          },
          mods: {
            header: {
              enabled: true,
              languages: {
                eng: "en",
                dut: "du",
                fre: "fr",
                ger: "ge",
                kor: "ko",
                spa: "es",
                cze: "cz",
                cat: "ca",
                fin: "fi",
                ice: "is"
              }
            },
            home: {
              enabled: true,
              appUrl: "#/home"
            },
            search: {
              enabled: true,
              appUrl: "#/search",
              hitsperpageValues: [10, 50, 100],
              filters: {},
              paginationInfo: {
                hitsPerPage: 20
              },
              facetsSummaryType: "details",
              sortbyValues: [
                {
                  sortBy: "relevance",
                  sortOrder: ""
                },
                {
                  sortBy: "changeDate",
                  sortOrder: ""
                },
                {
                  sortBy: "title",
                  sortOrder: "reverse"
                },
                {
                  sortBy: "rating",
                  sortOrder: ""
                },
                {
                  sortBy: "popularity",
                  sortOrder: ""
                },
                {
                  sortBy: "denominatorDesc",
                  sortOrder: ""
                },
                {
                  sortBy: "denominatorAsc",
                  sortOrder: "reverse"
                }
              ],
              sortBy: "relevance",
              resultViewTpls: [
                {
                  tplUrl:
                    "../../sextant/components/search/resultsview/partials/viewtemplates/grid.html",
                  tooltip: "Grid",
                  icon: "fa-th"
                }
              ],
              resultTemplate:
                "../../sextant/components/search/resultsview/partials/viewtemplates/grid.html",
              formatter: {
                list: [
                  {
                    label: "full",
                    url: "../api/records/{{md.getUuid()}}/formatters/xsl-view?root=div&view=advanced"
                  }
                ]
              },
              linkTypes: {
                links: ["LINK", "kml"],
                downloads: ["DOWNLOAD"],
                layers: ["OGC"],
                maps: ["ows"]
              }
            },
            map: {
              enabled: true,
              appUrl: "#/map",
              is3DModeAllowed: true,
              storage: "sessionStorage",
              map: "../../map/config-viewer.xml",
              listOfServices: {
                wms: [{ name: "BRGM", url: "http://geoservices.brgm.fr/geologie" }],
                wmts: []
              },
              useOSM: true,
              context: "",
              layer: {
                url: "http://www2.demis.nl/mapserver/wms.asp?",
                layers: "Countries",
                version: "1.1.1"
              },
              projection: "EPSG:3857",
              projectionList: [
                {
                  code: "EPSG:4326",
                  label: "WGS84 (EPSG:4326)"
                },
                {
                  code: "EPSG:3857",
                  label: "Google mercator (EPSG:3857)"
                }
              ]
            },
            editor: {
              enabled: true,
              appUrl: "../../srv/eng/catalog.edit"
            },
            admin: {
              enabled: true,
              appUrl: "../../srv/eng/admin.console"
            },
            signin: {
              enabled: true,
              appUrl: "../../srv/eng/catalog.signin"
            },
            signout: {
              appUrl: "../../signout"
            }
          }
        };

      if (config) {
        try {
          config = angular.fromJson(decodeURIComponent(config));
        } catch (e) {
          console.warn("Invalid configuration: " + config + ". Using default.");
          console.warn(e);
          config = defaultConfig;
        }
      } else {
        config = defaultConfig;
      }

      var module = angular.module("gn_search");
      module.config([
        "gnViewerSettings",
        "gnSearchSettings",
        "gnGlobalSettings",
        function (gnViewerSettings, gnSearchSettings, gnGlobalSettings) {
          gnGlobalSettings.init(
            config,
            "http://gnapi/geonetwork/srv/",
            gnViewerSettings,
            gnSearchSettings
          );
        }
      ]);
    </script>
  </body>
</html>
