<span data-ng-controller="GnSearchFormController">
  <div class="input-group">
    <div class="input-group-btn">
      <button class="btn btn-default" type="button" title="{{'add' | translate}}"
        data-ng-click="add();">
        <i class="fa fa-plus"/>
        <span>&nbsp;</span>
      </button>
    </div>

    <!-- TODO: could be nice to filter by organisation -->
    <input type="text" class="form-control" placeholder="{{'searchAContact' | translate}}"
           data-ng-model="params.any" data-ng-change="triggerSearch('qi@json')"/>

    <!-- The autocomplete list -->
    <div class="list-group tt-dropdown-menu gn-autocomplete-list"
        data-ng-show="searchResults.records">
      <span class="tt-suggestions">
        <div class="tt-suggestion"
            data-ng-repeat="r in searchResults.records"> {{r.title}}
          <span class="pull-right">
            <div class="btn-group"
                 title="{{'addContactAsText-help' | translate}}">
              <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                <i class="fa fa-plus"></i><span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu">
                <li data-ng-repeat="role in roles" data-ng-hide="role['@hideInEditMode']">
                  <a href="" data-ng-click="addContact(r, role.code)" title="{{role.description}}">
                    {{role.label}}
                  </a>
                </li>
              </ul>
            </div>
            <div data-ng-show="gnConfig[gnConfig.key.isXLinkEnabled]"
                 title="{{'addContactAsLink-help' | translate}}"
                 class="btn-group">
              <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                <i class="fa fa-link"></i><span class="caret"></span>
              </button>
              <ul class="dropdown-menu" role="menu">
                <li data-ng-repeat="role in roles" data-ng-hide="role['@hideInEditMode']">
                  <a href="" data-ng-click="addContact(r, role.code, true)" title="{{role.description}}">
                    {{role.label}}
                  </a>
                </li>
              </ul>
            </div>
          </span>
          <div class="clearfix"></div>
        </div>
      </span>
    </div>

    <div class="input-group-btn">
      <button class="btn btn-default" type="button"
              data-ng-show="searchResults.records.length != 0"
              data-ng-click="searchResults.records = []">
        <i class="fa fa-times"></i>
        <span>&nbsp;</span>
      </button>
    </div>

    <!-- The contact to insert once received -->
    <div data-ng-if="snippet">
      <input name="{{snippetRef}}" type="hidden" value="{{snippet}}"/>
    </div>
  </div>

</span>
