<div class="btn-group md-actions">
  <button type="button" class="btn btn-default dropdown-toggle"
          data-toggle="dropdown"
          title="{{::'toAdmin' | translate}}">
    <i class="fa fa-gear"></i>
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" role="menu">
    <li ng-if="user.canEditRecord(md)">
      <!-- Force CERSAT record to use UI in english. -->
      <a ng-show="md.standardName === 'ISO 19115-3:2018 - Remote Sensing'" ng-href="{{::gnUrl}}../eng/catalog.edit#/metadata/{{::md.id}}" target="_blank">
        <i class="fa fa-pencil"></i>
        <span translate>edit</span>
      </a>
      <a ng-hide="md.standardName === 'ISO 19115-3:2018 - Remote Sensing'" ng-href="{{::gnUrl}}catalog.edit#/metadata/{{::md.id}}" target="_blank">
        <i class="fa fa-pencil"></i>
        <span translate>edit</span>
      </a>
    </li>

    <li data-ng-if="user.canManagePrivileges(md)">
      <a ng-href=""
         data-ng-click="mdService.openPrivilegesPanel(md, getCatScope())"><i
        class="fa fa-key"></i><span translate>privileges</span></a></li>
    <li data-ng-if="!user.canManagePrivileges(md)"
        class="disabled"><a ng-href="">
      <i class="fa fa-key"></i><span
      translate>privileges</span></a></li>

    <li data-ng-if="!user.isReviewerOrMore()"
        class="disabled"><a href="">
      <i class="fa fa-trash-o"></i><span
      translate>delete</span></a>
    </li>

    <!--
      Workflow:
      See https://github.com/geonetwork/core-geonetwork/pull/3600
      Editor
      - if status is 'Draft' (mdStatus = 1) -> label = 'Submit for review'
      - if status <> 'Draft' hide the menu
      - data submitted by user - cancel approval
      Reviewer
      - 3 options in menu:
        1. Approve metadata (id = 2)
        2. Reject metadata (id = 5)
        3. Retire metadata (id = 3)
    -->

    <li data-ng-if="user.isReviewerOrMore()">
      <a data-gn-click-and-spin="mdService.deleteMd(md)"
         data-gn-confirm-click="{{::('deleteRecordConfirm' | translate:md)}}">
        <i class="fa fa-trash-o"></i>
        <span translate>delete</span>
      </a>
    </li>

    <li role="menuitem" class="divider"/>

    <li>
      <a ng-href="" data-ng-click="mdService.duplicate(md)">
        <i class="fa fa-copy"></i><span
        translate>duplicate</span></a>
    </li>
    <li><a ng-href="" data-ng-click="mdService.createChild(md)">
      <i class="fa fa-sitemap"></i><span translate>createChild</span></a>
    </li>

    <li role="menuitem"
        data-ng-show="isMdWorkflowEnable"
        class="divider"/>
    <li role="menuitem" class="divider"
        data-ng-show="user.canEditRecord(md) && isMdWorkflowEnable && (md.mdStatus == 1 || md.mdStatus == 4)">
    </li>
    <li role="menuitem"
        class="dropdown-header"
        data-ng-show="user.canEditRecord(md) && isMdWorkflowEnable && md.mdStatus">
      <span data-translate="">workflow</span>
      ({{('mdStatus-' + md.mdStatus) | translate}})
    </li>
    <li role="menuitem"
        class="dropdown-header"
        data-ng-show="user.canEditRecord(md) && isMdWorkflowEnable && !md.mdStatus">
      <span data-translate="">workflow</span>
    </li>
    <!-- user = editor, status = 1, statusToSelect = 4 -->
    <li role="menuitem"
        data-ng-if="user.canEditRecord(md) && (user.isAdmin() ||
          user.isEditorForGroup(md.groupOwner)) && md.mdStatus == 1 && isMdWorkflowEnable && md.isWorkflowEnabled()">
      <a data-ng-href=""
         data-ng-click="mdService.openUpdateStatusPanel(getScope(), 'workflow', null, 4, 14)">
        <i class="fa fa-fw fa-file-o"></i>&nbsp;
        <span data-translate="">mdStatusTitle-14</span>
      </a>
    </li>
    <li role="menuitem"
        data-ng-if="user.canEditRecord(md) && (user.isAdmin() ||
          user.isEditorForGroup(md.groupOwner)) && md.mdStatus == 3 && isMdWorkflowEnable && md.isWorkflowEnabled()">
      <a data-ng-href=""
         data-ng-click="mdService.openUpdateStatusPanel(getScope(), 'workflow', null, 1, 31)">
        <i class="fa fa-fw fa-file-o"></i>&nbsp;
        <span data-translate="">mdStatusTitle-31</span>
      </a>
    </li>
    <!-- user = editor, status = 4, statusToSelect = 1 -->
    <li role="menuitem"
        data-ng-if="user.canEditRecord(md) && !user.isReviewerForGroup(md.groupOwner) &&
          user.isEditorForGroup(md.groupOwner) && md.mdStatus == 4  && isMdWorkflowEnable && md.isWorkflowEnabled()">
      <a data-ng-href=""
         data-ng-click="mdService.openUpdateStatusPanel(getScope(), 'workflow', null, 1, 41)">
        <i class="fa fa-fw fa-undo"></i>&nbsp;
        <span data-translate="">mdStatusTitle-41</span>
      </a>
    </li>
    <!-- user = reviewer, status = 4, statusToSelect = 2 -->
    <li role="menuitem"
        data-ng-if="user.canEditRecord(md) && (user.isAdmin() || user.isReviewerForGroup(md.groupOwner)) &&
          md.mdStatus == 4  && isMdWorkflowEnable && md.isWorkflowEnabled()">
      <a data-ng-href=""
         data-ng-click="mdService.openUpdateStatusPanel(getScope(), 'workflow', null, 2, 42)">
        <i class="fa fa-fw fa-thumbs-o-up"></i>&nbsp;
        <span data-translate="">mdStatusTitle-42</span>
      </a>
    </li>
    <li role="menuitem"
        data-ng-if="user.canEditRecord(md) && (user.isAdmin() || user.isReviewerForGroup(md.groupOwner)) &&
          md.mdStatus == 1  && isMdWorkflowEnable && md.isWorkflowEnabled()">
      <a data-ng-href=""
         data-ng-click="mdService.openUpdateStatusPanel(getScope(), 'workflow', null, 2, 12)">
        <i class="fa fa-fw fa-thumbs-o-up"></i>&nbsp;
        <span data-translate="">mdStatusTitle-12</span>
      </a>
    </li>
    <!-- user = reviewer, status = 4, statusToSelect = 5 -->
    <li role="menuitem"
        data-ng-if="user.canEditRecord(md) && (user.isAdmin() || user.isReviewerForGroup(md.groupOwner)) &&
          md.mdStatus == 4  && isMdWorkflowEnable && md.isWorkflowEnabled()">
      <a data-ng-href=""
         data-ng-click="mdService.openUpdateStatusPanel(getScope(), 'workflow', null, 1, 411)">
        <i class="fa fa-fw fa-thumbs-o-down"></i>&nbsp;
        <span data-translate="">mdStatusTitle-411</span>
      </a>
    </li>
    <!-- user = reviewer, status = 4, statusToSelect = 3 -->
    <li role="menuitem"
        data-ng-if="user.canEditRecord(md) && (user.isAdmin() || user.isReviewerForGroup(md.groupOwner)) &&
          md.mdStatus == 4  && isMdWorkflowEnable && md.isWorkflowEnabled()">
      <a data-ng-href=""
         data-ng-click="mdService.openUpdateStatusPanel(getScope(), 'workflow', null, 3, 33)">
        <i class="fa fa-fw fa-archive"></i>&nbsp;
        <span data-translate="">mdStatusTitle-33</span>
      </a>
    </li>
    <li data-ng-if="isMdWorkflowEnable && user.canEditRecord(md) && !md.isWorkflowEnabled()">
      <a role="menuitem"
         data-ng-href=""
         data-ng-click="mdService.startWorkflow(md, getCatScope())">
        <i class="fa fa-fw fa-code-fork"></i>
        <span data-translate="">enableWorkflow</span>
      </a>
    </li>




    <li data-ng-repeat="t in tasks"
        data-ng-if="!doiDefined && user.canEditRecord(md)"
        data-ng-show="taskConfiguration[t.name] && taskConfiguration[t.name].isVisible && taskConfiguration[t.name].isVisible(md)"
        data-ng-class="::{'disabled': !taskConfiguration[t.name].isApplicable(md)}">
      <a role="menuitem"
         data-ng-click="mdService.openUpdateStatusPanel(getScope(md), 'task', t)">
        <i class="fa fa-fw"></i>
        <span>{{t.label | gnLocalized}}</span>
      </a>
    </li>
    <li role="menuitem"
        class="dropdown-header"
        data-ng-if="doiDefined && user.canEditRecord(md)">
      <span data-translate="">doiDefinedForRecord</span>
    </li>

  </ul>
</div>
